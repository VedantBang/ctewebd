<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Question 1</title>
	<style type="text/css">
		.code {
			font-family: monospace;
		}
		.button {
			background-color: black;
			color: white;
			padding: 3px;
			cursor: pointer;
		}
		.gray{
			color:  gray;
		}
		.green{
			color: green;
		}
		.red{
			color: red;
		}
	</style>
</head>
<body style="font-family: Garamond;">
	<h1>CORS: The first necessary thing</h1>
	<ul>
	<li>CORS refers to Cross Origin Resource Sharing. It is a set of rules followed by browsers.</li>
	<li>When a server S1 serves a webpage, the origin of that webpage is S1. When certain code on this webpage makes a request to some resource on S1, the request is a 'same-origin request'.</li>
	<li>If that webpage makes a request to a different server S2, the request is 'cross-origin request'.</li>
	<li>CORS is a security feature built into browsers to not allow access to resources on the internet from random locations.</li>
	<li>As a measure of security, whenever a webpage makes a cross-origin request, the browser first sends a 'Pre-Flight request' asking the server if it is okay to make such a cross-origin request.</li>
	<li>The server should then respond (to the pre-flight request) with the alloweds origins (for a potential request) and the allowed methods (for a potential request).</li>
	<li>If the browser receives a satisfactory response for the pre-flight request, only then it allows the webpage to go ahead with making the request.</li>
	</ul>
	<h2>Question:</h2>
	<h4>
		Write code for a server which returns the string <span class='code'>'CORS Setup Done'</span>, on a <span class='code'>GET</span> request on the path <span class='code'>'/corscheck'</span>.
	</h4>
	<h4>You will be able to attempt rest of the problems only if you are able to solve this one, since all requests made to evaluate your code will be cross-origin.</h4>
	<h4>Check the browser console for errors if any.</h4>
	<form>
		Server address 
		<input type="text" name="" id="address">
	</form>
	<div>
		<span class='button' onclick='check()'>Submit</span>
	</div>
	<h2>Objectives Checklist:</h2>
	<ul>
		<li class='gray' id='o1'>
			GET Request on /corscheck returns string 'CORS Setup Done'.
		</li>
	</ul>

	<script type="text/javascript">
		async function check() {
			document.querySelector('#o1').classList.remove('red');
			document.querySelector('#o1').classList.remove('green');
			document.querySelector('#o1').classList.add('gray');
			const address = document.querySelector('#address').value;
			try{
				let res = await fetch(address+'/corscheck');
				let output = await res.text();
				document.querySelector('#o1').classList.remove('gray');
				if(output === 'CORS Setup Done'){
					document.querySelector('#o1').classList.add('green');
				} else {
					document.querySelector('#o1').classList.add('red');
					console.log("Text from response does not match the requirement.");
				}
			} catch(err){
				console.log(err);
				document.querySelector('#o1').classList.remove('gray');
				document.querySelector('#o1').classList.add('red');
			}
		}
	</script>
</body>
</html>